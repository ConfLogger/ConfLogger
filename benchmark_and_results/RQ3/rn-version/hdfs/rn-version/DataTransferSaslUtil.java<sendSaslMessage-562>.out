====================TaintedSinkInfo:=======================
-------------TaintedSinkInfo----------
fileName:	DataTransferSaslUtil.java	methodSinagture:	org.apache.hadoop.hdfs.protocol.datatransfer.sasl.DataTransferSaslUtil.sendSaslMessage(Ljava/io/OutputStream;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$DataTransferEncryptorMessageProto$DataTransferEncryptorStatus;[BLjava/lang/String;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$HandshakeSecretProto;Z)V	methodLines:	562:582
blockLines:	566:-1
paras:	null
TaintedStat:	NORMAL sendSaslMessage:conditional branch(eq, to iindex=14) 3,12 Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/DataTransferSaslUtil, sendSaslMessage(Ljava/io/OutputStream;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$DataTransferEncryptorMessageProto$DataTransferEncryptorStatus;[BLjava/lang/String;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$HandshakeSecretProto;Z)V > Context: Everywhere
Source:	NORMAL_RET_CALLER:Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/SaslDataTransferClient, doSaslHandshake(Ljava/net/InetAddress;Ljava/io/OutputStream;Ljava/io/InputStream;Ljava/lang/String;Ljava/util/Map;Ljavax/security/auth/callback/CallbackHandler;Lorg/apache/hadoop/security/token/Token;)Lorg/apache/hadoop/hdfs/protocol/datatransfer/IOStreamPair; > Context: Everywhere[93]63 = invokevirtual < Application, Lorg/apache/hadoop/conf/Configuration, get(Ljava/lang/String;)Ljava/lang/String; > 60,61 @211 exception:62
Tainted Path:	NORMAL_RET_CALLER:Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/SaslDataTransferClient, doSaslHandshake(Ljava/net/InetAddress;Ljava/io/OutputStream;Ljava/io/InputStream;Ljava/lang/String;Ljava/util/Map;Ljavax/security/auth/callback/CallbackHandler;Lorg/apache/hadoop/security/token/Token;)Lorg/apache/hadoop/hdfs/protocol/datatransfer/IOStreamPair; > Context: Everywhere[93]63 = invokevirtual < Application, Lorg/apache/hadoop/conf/Configuration, get(Ljava/lang/String;)Ljava/lang/String; > 60,61 @211 exception:62
NORMAL doSaslHandshake:conditional branch(eq, to iindex=203) 63,22 Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/SaslDataTransferClient, doSaslHandshake(Ljava/net/InetAddress;Ljava/io/OutputStream;Ljava/io/InputStream;Ljava/lang/String;Ljava/util/Map;Ljavax/security/auth/callback/CallbackHandler;Lorg/apache/hadoop/security/token/Token;)Lorg/apache/hadoop/hdfs/protocol/datatransfer/IOStreamPair; > Context: Everywhere
PHI Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/SaslDataTransferClient, doSaslHandshake(Ljava/net/InetAddress;Ljava/io/OutputStream;Ljava/io/InputStream;Ljava/lang/String;Ljava/util/Map;Ljavax/security/auth/callback/CallbackHandler;Lorg/apache/hadoop/security/token/Token;)Lorg/apache/hadoop/hdfs/protocol/datatransfer/IOStreamPair; > Context: Everywhere:110 = phi  22,94,94,94,94,94
NORMAL doSaslHandshake:conditional branch(eq, to iindex=214) 110,22 Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/SaslDataTransferClient, doSaslHandshake(Ljava/net/InetAddress;Ljava/io/OutputStream;Ljava/io/InputStream;Ljava/lang/String;Ljava/util/Map;Ljavax/security/auth/callback/CallbackHandler;Lorg/apache/hadoop/security/token/Token;)Lorg/apache/hadoop/hdfs/protocol/datatransfer/IOStreamPair; > Context: Everywhere
NORMAL doSaslHandshake:113 = getfield < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/SaslDataTransferClient, conf, <Application,Lorg/apache/hadoop/conf/Configuration> > 1 Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/SaslDataTransferClient, doSaslHandshake(Ljava/net/InetAddress;Ljava/io/OutputStream;Ljava/io/InputStream;Ljava/lang/String;Ljava/util/Map;Ljavax/security/auth/callback/CallbackHandler;Lorg/apache/hadoop/security/token/Token;)Lorg/apache/hadoop/hdfs/protocol/datatransfer/IOStreamPair; > Context: Everywhere
PARAM_CALLER:Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/SaslDataTransferClient, doSaslHandshake(Ljava/net/InetAddress;Ljava/io/OutputStream;Ljava/io/InputStream;Ljava/lang/String;Ljava/util/Map;Ljavax/security/auth/callback/CallbackHandler;Lorg/apache/hadoop/security/token/Token;)Lorg/apache/hadoop/hdfs/protocol/datatransfer/IOStreamPair; > Context: Everywhere[212]115 = invokestatic < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/DataTransferSaslUtil, createStreamPair(Lorg/apache/hadoop/conf/Configuration;Lorg/apache/hadoop/crypto/CipherOption;Ljava/io/OutputStream;Ljava/io/InputStream;Z)Lorg/apache/hadoop/hdfs/protocol/datatransfer/IOStreamPair; > 113,110,3,4,26 @461 exception:114 v113
PARAM_CALLEE:Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/DataTransferSaslUtil, createStreamPair(Lorg/apache/hadoop/conf/Configuration;Lorg/apache/hadoop/crypto/CipherOption;Ljava/io/OutputStream;Ljava/io/InputStream;Z)Lorg/apache/hadoop/hdfs/protocol/datatransfer/IOStreamPair; > Context: Everywhere v1
PARAM_CALLER:Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/DataTransferSaslUtil, createStreamPair(Lorg/apache/hadoop/conf/Configuration;Lorg/apache/hadoop/crypto/CipherOption;Ljava/io/OutputStream;Ljava/io/InputStream;Z)Lorg/apache/hadoop/hdfs/protocol/datatransfer/IOStreamPair; > Context: Everywhere[6]13 = invokestatic < Application, Lorg/apache/hadoop/crypto/CryptoCodec, getInstance(Lorg/apache/hadoop/conf/Configuration;Lorg/apache/hadoop/crypto/CipherSuite;)Lorg/apache/hadoop/crypto/CryptoCodec; > 1,11 @15 exception:12 v1
PARAM_CALLEE:Node: < Extension, Lorg/apache/hadoop/crypto/CryptoCodec, getInstance(Lorg/apache/hadoop/conf/Configuration;Lorg/apache/hadoop/crypto/CipherSuite;)Lorg/apache/hadoop/crypto/CryptoCodec; > Context: Everywhere v1
NORMAL getInstance:16 = invokestatic < Extension, Lorg/apache/hadoop/util/ReflectionUtils, newInstance(Ljava/lang/Class;Lorg/apache/hadoop/conf/Configuration;)Ljava/lang/Object; > 14,1 @47 exception:15 Node: < Extension, Lorg/apache/hadoop/crypto/CryptoCodec, getInstance(Lorg/apache/hadoop/conf/Configuration;Lorg/apache/hadoop/crypto/CipherSuite;)Lorg/apache/hadoop/crypto/CryptoCodec; > Context: Everywhere
METHOD_ENTRY:Node: < Extension, Lorg/apache/hadoop/util/ReflectionUtils, newInstance(Ljava/lang/Class;Lorg/apache/hadoop/conf/Configuration;)Ljava/lang/Object; > Context: Everywhere
NORMAL newInstance:return 21 Node: < Extension, Lorg/apache/hadoop/util/ReflectionUtils, newInstance(Ljava/lang/Class;Lorg/apache/hadoop/conf/Configuration;)Ljava/lang/Object; > Context: Everywhere
NORMAL_RET_CALLEE:Node: < Extension, Lorg/apache/hadoop/util/ReflectionUtils, newInstance(Ljava/lang/Class;Lorg/apache/hadoop/conf/Configuration;)Ljava/lang/Object; > Context: Everywhere
NORMAL_RET_CALLER:Node: < Extension, Lorg/apache/hadoop/security/token/Token, decodeIdentifier()Lorg/apache/hadoop/security/token/TokenIdentifier; > Context: Everywhere[11]9 = invokestatic < Extension, Lorg/apache/hadoop/util/ReflectionUtils, newInstance(Ljava/lang/Class;Lorg/apache/hadoop/conf/Configuration;)Ljava/lang/Object; > 6,7 @16 exception:8
NORMAL decodeIdentifier:10 = checkcast <Extension,Lorg/apache/hadoop/security/token/TokenIdentifier>9 <Extension,Lorg/apache/hadoop/security/token/TokenIdentifier> Node: < Extension, Lorg/apache/hadoop/security/token/Token, decodeIdentifier()Lorg/apache/hadoop/security/token/TokenIdentifier; > Context: Everywhere
NORMAL decodeIdentifier:return 10 Node: < Extension, Lorg/apache/hadoop/security/token/Token, decodeIdentifier()Lorg/apache/hadoop/security/token/TokenIdentifier; > Context: Everywhere
NORMAL_RET_CALLEE:Node: < Extension, Lorg/apache/hadoop/security/token/Token, decodeIdentifier()Lorg/apache/hadoop/security/token/TokenIdentifier; > Context: Everywhere
NORMAL_RET_CALLER:Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/SaslDataTransferClient, doSaslHandshake(Ljava/net/InetAddress;Ljava/io/OutputStream;Ljava/io/InputStream;Ljava/lang/String;Ljava/util/Map;Ljavax/security/auth/callback/CallbackHandler;Lorg/apache/hadoop/security/token/Token;)Lorg/apache/hadoop/hdfs/protocol/datatransfer/IOStreamPair; > Context: Everywhere[21]20 = invokevirtual < Application, Lorg/apache/hadoop/security/token/Token, decodeIdentifier()Lorg/apache/hadoop/security/token/TokenIdentifier; > 8 @45 exception:19
NORMAL doSaslHandshake:21 = checkcast <Application,Lorg/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier>20 <Application,Lorg/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier> Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/SaslDataTransferClient, doSaslHandshake(Ljava/net/InetAddress;Ljava/io/OutputStream;Ljava/io/InputStream;Ljava/lang/String;Ljava/util/Map;Ljavax/security/auth/callback/CallbackHandler;Lorg/apache/hadoop/security/token/Token;)Lorg/apache/hadoop/hdfs/protocol/datatransfer/IOStreamPair; > Context: Everywhere
NORMAL doSaslHandshake:conditional branch(eq, to iindex=74) 21,22 Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/SaslDataTransferClient, doSaslHandshake(Ljava/net/InetAddress;Ljava/io/OutputStream;Ljava/io/InputStream;Ljava/lang/String;Ljava/util/Map;Ljavax/security/auth/callback/CallbackHandler;Lorg/apache/hadoop/security/token/Token;)Lorg/apache/hadoop/hdfs/protocol/datatransfer/IOStreamPair; > Context: Everywhere
NORMAL doSaslHandshake:27 = new <Primordial,[B>@18126  Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/SaslDataTransferClient, doSaslHandshake(Ljava/net/InetAddress;Ljava/io/OutputStream;Ljava/io/InputStream;Ljava/lang/String;Ljava/util/Map;Ljavax/security/auth/callback/CallbackHandler;Lorg/apache/hadoop/security/token/Token;)Lorg/apache/hadoop/hdfs/protocol/datatransfer/IOStreamPair; > Context: Everywhere
PARAM_CALLER:Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/SaslDataTransferClient, doSaslHandshake(Ljava/net/InetAddress;Ljava/io/OutputStream;Ljava/io/InputStream;Ljava/lang/String;Ljava/util/Map;Ljavax/security/auth/callback/CallbackHandler;Lorg/apache/hadoop/security/token/Token;)Lorg/apache/hadoop/hdfs/protocol/datatransfer/IOStreamPair; > Context: Everywhere[80]invokestatic < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/DataTransferSaslUtil, sendSaslMessage(Ljava/io/OutputStream;[B)V > 10,27 @183 exception:28 v27
PARAM_CALLEE:Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/DataTransferSaslUtil, sendSaslMessage(Ljava/io/OutputStream;[B)V > Context: Everywhere v2
PARAM_CALLER:Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/DataTransferSaslUtil, sendSaslMessage(Ljava/io/OutputStream;[B)V > Context: Everywhere[4]invokestatic < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/DataTransferSaslUtil, sendSaslMessage(Ljava/io/OutputStream;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$DataTransferEncryptorMessageProto$DataTransferEncryptorStatus;[BLjava/lang/String;)V > 1,4,2,5 @6 exception:6 v2
PARAM_CALLEE:Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/DataTransferSaslUtil, sendSaslMessage(Ljava/io/OutputStream;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$DataTransferEncryptorMessageProto$DataTransferEncryptorStatus;[BLjava/lang/String;)V > Context: Everywhere v3
PARAM_CALLER:Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/DataTransferSaslUtil, sendSaslMessage(Ljava/io/OutputStream;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$DataTransferEncryptorMessageProto$DataTransferEncryptorStatus;[BLjava/lang/String;)V > Context: Everywhere[5]invokestatic < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/DataTransferSaslUtil, sendSaslMessage(Ljava/io/OutputStream;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$DataTransferEncryptorMessageProto$DataTransferEncryptorStatus;[BLjava/lang/String;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$HandshakeSecretProto;)V > 1,2,3,4,6 @5 exception:7 v3
PARAM_CALLEE:Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/DataTransferSaslUtil, sendSaslMessage(Ljava/io/OutputStream;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$DataTransferEncryptorMessageProto$DataTransferEncryptorStatus;[BLjava/lang/String;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$HandshakeSecretProto;)V > Context: Everywhere v3
PARAM_CALLER:Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/DataTransferSaslUtil, sendSaslMessage(Ljava/io/OutputStream;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$DataTransferEncryptorMessageProto$DataTransferEncryptorStatus;[BLjava/lang/String;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$HandshakeSecretProto;)V > Context: Everywhere[6]invokestatic < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/DataTransferSaslUtil, sendSaslMessage(Ljava/io/OutputStream;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$DataTransferEncryptorMessageProto$DataTransferEncryptorStatus;[BLjava/lang/String;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$HandshakeSecretProto;Z)V > 1,2,3,4,5,7 @7 exception:8 v3
PARAM_CALLEE:Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/DataTransferSaslUtil, sendSaslMessage(Ljava/io/OutputStream;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$DataTransferEncryptorMessageProto$DataTransferEncryptorStatus;[BLjava/lang/String;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$HandshakeSecretProto;Z)V > Context: Everywhere v3
NORMAL sendSaslMessage:conditional branch(eq, to iindex=14) 3,12 Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/DataTransferSaslUtil, sendSaslMessage(Ljava/io/OutputStream;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$DataTransferEncryptorMessageProto$DataTransferEncryptorStatus;[BLjava/lang/String;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$HandshakeSecretProto;Z)V > Context: Everywhere



====================ExtendedBlocks:=======================


====================MethodSrc:=======================
    DataTransferEncryptorMessageProto.Builder builder =
        DataTransferEncryptorMessageProto.newBuilder();

    builder.setStatus(status);
    if (payload != null) {
      builder.setPayload(ByteString.copyFrom(payload));
    }
    if (message != null) {
      builder.setMessage(message);
    }
    if (handshakeSecret != null) {
      builder.setHandshakeSecret(handshakeSecret);
    }
    if (accessTokenError) {
      builder.setAccessTokenError(true);
    }

    DataTransferEncryptorMessageProto proto = builder.build();
    proto.writeDelimitedTo(out);
    out.flush();
  }



====================ctx:=======================
CtxCodeBlock{node=Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/DataTransferSaslUtil, sendSaslMessage(Ljava/io/OutputStream;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$DataTransferEncryptorMessageProto$DataTransferEncryptorStatus;[BLjava/lang/String;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$HandshakeSecretProto;)V > Context: Everywhere, blocks=[BB[SSA:0..6]1 - org.apache.hadoop.hdfs.protocol.datatransfer.sasl.DataTransferSaslUtil.sendSaslMessage(Ljava/io/OutputStream;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$DataTransferEncryptorMessageProto$DataTransferEncryptorStatus;[BLjava/lang/String;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$HandshakeSecretProto;)V, BB[SSA:-1..-2]0 - org.apache.hadoop.hdfs.protocol.datatransfer.sasl.DataTransferSaslUtil.sendSaslMessage(Ljava/io/OutputStream;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$DataTransferEncryptorMessageProto$DataTransferEncryptorStatus;[BLjava/lang/String;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$HandshakeSecretProto;)V, BB[SSA:7..7]2 - org.apache.hadoop.hdfs.protocol.datatransfer.sasl.DataTransferSaslUtil.sendSaslMessage(Ljava/io/OutputStream;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$DataTransferEncryptorMessageProto$DataTransferEncryptorStatus;[BLjava/lang/String;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$HandshakeSecretProto;)V, BB[SSA:-1..-2]3 - org.apache.hadoop.hdfs.protocol.datatransfer.sasl.DataTransferSaslUtil.sendSaslMessage(Ljava/io/OutputStream;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$DataTransferEncryptorMessageProto$DataTransferEncryptorStatus;[BLjava/lang/String;Lorg/apache/hadoop/hdfs/protocol/proto/DataTransferProtos$HandshakeSecretProto;)V], numberOfBasicBlocks=4, firstLineNumber=554, lastLineNumber=556, firstMethodNumber=554, lastMethodNumber=556, isFirstLineValid=false, methodSrcCode=
      throws IOException {
    sendSaslMessage(out, status, payload, message, handshakeSecret, false);
  }

}
CtxCodeBlock{node=Node: < Application, Lorg/apache/hadoop/hdfs/protocol/datatransfer/sasl/SaslDataTransferServer, sendInvalidTokenSaslErrorMessage(Ljava/io/DataOutputStream;Ljava/lang/String;)V > Context: Everywhere, blocks=[BB[SSA:0..6]1 - org.apache.hadoop.hdfs.protocol.datatransfer.sasl.SaslDataTransferServer.sendInvalidTokenSaslErrorMessage(Ljava/io/DataOutputStream;Ljava/lang/String;)V, BB[SSA:-1..-2]0 - org.apache.hadoop.hdfs.protocol.datatransfer.sasl.SaslDataTransferServer.sendInvalidTokenSaslErrorMessage(Ljava/io/DataOutputStream;Ljava/lang/String;)V, BB[SSA:7..7]2 - org.apache.hadoop.hdfs.protocol.datatransfer.sasl.SaslDataTransferServer.sendInvalidTokenSaslErrorMessage(Ljava/io/DataOutputStream;Ljava/lang/String;)V, BB[SSA:-1..-2]3 - org.apache.hadoop.hdfs.protocol.datatransfer.sasl.SaslDataTransferServer.sendInvalidTokenSaslErrorMessage(Ljava/io/DataOutputStream;Ljava/lang/String;)V], numberOfBasicBlocks=4, firstLineNumber=482, lastLineNumber=484, firstMethodNumber=482, lastMethodNumber=484, isFirstLineValid=false, methodSrcCode=
      String message) throws IOException {
    sendSaslMessage(out, DataTransferEncryptorStatus.ERROR, null, message, null, true);
  }
}
}
